<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Smart City Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>

  <style>

  @keyframes marqueeScroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-50%);
  }
}

.marquee-track {
  display: inline-block;
  white-space: nowrap;
  animation: marqueeScroll 20s linear infinite;
}


    .responsive-wrapper {
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      flex-wrap: wrap;
      gap: 1rem;
      padding: 2rem;
    }

    .function_card {
      position: relative;
      background-color: rgba(45, 55, 72, 0.3);
      border-radius: 0.5rem;
      font-size: 1.125rem;
      width: 300px;
      height: 400px;
      backdrop-filter: blur(10px);
      color: white;
      display: flex;
      flex-direction: column;
      padding: 1rem;
      overflow: hidden;
      
    }
    /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô Smart People */
.smart-people-content {
  width: 100%;
  max-width: 260px;           /* ‡∏•‡∏î‡∏à‡∏≤‡∏Å 280px */
  margin: 0 auto;             /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
  padding: 1rem;
  box-sizing: border-box;     /* ‡∏£‡∏ß‡∏° padding ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô max-width */
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  text-align: left;
  height: 100%;               /* ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î */
  justify-content: center;    /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  align-items: center;        /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
}

.smart-people-content h3 {
  text-align: center;
  margin-bottom: 1rem;
  width: 100%;
}

.smart-people-content > div {
  display: flex;
  justify-content: space-between;
  width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  align-items: center;
}

.function_card > .smart-people-content {
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;  /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  align-items: center;      /* ‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
}
@keyframes pulseGlowRenewable {
  0% {
    box-shadow: 0 0 5px 2px #4caf50;
    opacity: 1;
  }
  50% {
    box-shadow: 0 0 20px 6px #4caf50;
    opacity: 0.6;
  }
  100% {
    box-shadow: 0 0 5px 2px #4caf50;
    opacity: 1;
  }
}

.line-center {
  line-height: 1;
}

.renewable-indicator {
  display: inline-block;
  width: 12px;
  height: 12px;
  background-color: #4caf50;
  border-radius: 50%;
  margin-right: 6px;
  vertical-align: middle;
  animation: pulseGlowRenewable 2s infinite ease-in-out;
  position: relative;
  left: -4px; /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏∏‡∏î‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ 4px */
}





    .header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .emoji_icon {
      font-size: 2.5rem;
      user-select: none;
      pointer-events: none;
    }

    .topic_text {
      font-size: 1.25rem;
      font-weight: 300;
      text-shadow: 0 0 1px rgba(255,255,255,0.4);
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö weather ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà */
#weather, #aqi {
  position: absolute;
  top: 3.5rem;
  left: 1rem;
  right: 1rem;
  margin-top: 0;
  color: #b0e0e6;
  font-weight: 300;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
}

    #weather-city {
      font-size: 1.2rem;
      font-weight: 400;
    }
    #weather-icon {
      font-size: 4.5rem !important; /* ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà */
      line-height: 1;
      user-select: none;
      pointer-events: none;
    }
    #weather-temp {
      font-size: 2.5rem;
      font-weight: 600;
      color: #ffce56;
      line-height: 1.1;
    }
    #weather-desc {
      font-size: 1.1rem;
      font-weight: 300;
      margin-bottom: 0.5rem;
      user-select: none;
    }

    /* Forecast marquee ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á weather card */
    #forecast-marquee {
      margin-top: auto; /* ‡∏î‡∏±‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î */
      background: rgba(0,0,0,0.2);
      padding: 6px 10px;
      font-size: 0.9rem;
      border-radius: 0.3rem;
      color: #fff;
      white-space: nowrap;
      overflow: hidden;
    }
    #forecast-marquee span {
      display: inline-block;
      padding-left: 100%;
      animation: marquee 30s linear infinite;
      user-select: none;
    }
    @keyframes marquee {
      0%   { transform: translateX(0%); }
      100% { transform: translateX(-100%); }
    }


.animate-marquee {
  animation: marquee 15s linear infinite;
}

    

    .switch-section {
      margin-top: 1rem;
      color: #b0e0e6;
      font-weight: 300;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
      position: absolute;
      top: 3.5rem;
      left: 1rem;
      right: 1rem;
    }

    .highlight-value {
      font-size: 2rem;
      font-weight: 600;
      text-align: center;
      color: #ffce56;
    }

    .hidden {
      display: none !important;
    }

    @keyframes fadeInScale {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    @keyframes fadeOutScale {
      from { opacity: 1; transform: scale(1); }
      to { opacity: 0; transform: scale(0.9); }
    }

    .fade-in-scale {
      animation: fadeInScale 0.6s forwards;
    }

    .fade-out-scale {
      animation: fadeOutScale 0.6s forwards;
    }

    #economyChart {
      width: 100%;
      aspect-ratio: 2 / 1;
      max-height: 180px;
    }
    .energy-value {
      text-align: center;
      margin-top: 2rem;
      color: #ffce56;
      font-weight: 600;
    }

    @media (max-width: 640px) {
      .function_card {
        width: 140px;
        height: 280px;
        font-size: 1rem;
        padding: 1rem;
      }
      .emoji_icon {
        font-size: 2rem;
      }
      .topic_text {
        font-size: 1rem;
      }
      .highlight-value {
        font-size: 1.25rem;
      }
      /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î weather */
      #weather-icon {
        font-size: 3.5rem !important;
      }
      #weather-temp {
        font-size: 2rem;
      }
      #weather-desc {
        font-size: 1rem;
      }
    }

    @media (max-width: 400px) {
      .function_card {
        width: 100px;
        height: 200px;
        font-size: 0.875rem;
        padding: 0.75rem;
      }
      .emoji_icon {
        font-size: 1.5rem;
      }
      .topic_text {
        font-size: 0.875rem;
      }
      .highlight-value {
        font-size: 1rem;
      }
      /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î weather */
      #weather-icon {
        font-size: 2.5rem !important;
      }
      #weather-temp {
        font-size: 1.5rem;
      }
      #weather-desc {
        font-size: 0.85rem;
      }
    }

    @keyframes pulseGlow {
      0% {
        box-shadow: 0 0 5px 2px #ffce56;
        opacity: 1;
      }
      50% {
        box-shadow: 0 0 20px 6px #ffce56;
        opacity: 0.6;
      }
      100% {
        box-shadow: 0 0 5px 2px #ffce56;
        opacity: 1;
      }
    }

    .energy-status-indicator {
      width: 15px;
      height: 15px;
      background-color: #ffce56;
      border-radius: 50%;
      display: inline-block;
      margin-right: 8px;
      animation: pulseGlow 2s infinite ease-in-out;
      vertical-align: middle;
    }
 

  .info-icon {
    cursor: pointer;
    font-weight: bold;
    font-size: 1.2rem;
    user-select: none;
    margin-left: 6px;
  }

.tooltip-box {
  position: absolute;
  top: 5rem;           /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° (‡∏à‡∏≤‡∏Å 3.5rem ‡πÄ‡∏õ‡πá‡∏ô 5rem) */
  left: 1rem;          /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏•‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡πá‡πÑ‡∏î‡πâ */
  right: 1rem;         /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏Ç‡∏ß‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° */
  width: auto;
  max-width: calc(100% - 2rem);  /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô (‡∏•‡∏î‡πÄ‡∏ß‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö) */
   background-color: rgba(0, 0, 0, 0.95);
  border-radius: 0.5rem;
  padding: 1.2rem 1.5rem;         /* ‡πÄ‡∏û‡∏¥‡πà‡∏° padding ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô */
  z-index: 20;
  display: none;
  color: white;
  font-size: 0.95rem;
  backdrop-filter: blur(8px);
  overflow: hidden;
  display: none;
}


.tooltip-box.show {
  display: block !important;
}


  </style>
</head>
<body class="bg-black text-white min-h-screen">

  <div class="responsive-wrapper">

    <!-- Smart Economy -->
<a href="/peopleShareing" style="text-decoration: none;">
  <div class="function_card hover:shadow-lg transition" style="position: relative; padding: 1rem;">
    <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <span class="emoji_icon">ü™ô</span>
        <span class="topic_text font-semibold text-lg">Smart Economy test</span>
      </div>
      <span class="info-icon" id="infoToggleEco" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
    </div>

    <!-- Tooltip box -->
    <div id="infoBoxEco" class="tooltip-box">
      ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à
    </div>

    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
<div class="bg-gray-900 bg-opacity-60 rounded-xl mt-1 p-4 text-gray-200 shadow-lg font-sans max-w-[270px] mx-auto overflow-hidden min-h-[400px]">

{% if latest_media_url %}
  {% if latest_media_url.endswith(('.mp4', '.webm', '.ogg')) %}
    <video class="rounded-md w-full aspect-square max-h-[120px] mb-4 object-cover rounded-md" controls autoplay loop muted>
  <source src="{{ latest_media_url }}" type="video/mp4">
  ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
</video>
  {% else %}
    <img src="{{ latest_media_url }}" class="w-full aspect-square max-h-[120px] mb-4 object-cover rounded-md" />
  {% endif %}
{% endif %}


  <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡∏¥‡πà‡∏á ‡∏õ‡∏£‡∏±‡∏ö font size ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á -->
  <div class="relative overflow-hidden h-8 border-b border-gray-700 py-1 mb-4">
    <div class="marquee-track whitespace-nowrap text-sm">
      <span class="font-semibold mr-16">{{ latest_name }} : {{ latest_description }}</span>
      <span class="font-semibold mr-16">{{ latest_name }} : {{ latest_description }}</span>
    </div>
  </div>

  <!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡πÅ‡∏•‡∏∞ ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏õ‡∏£‡∏±‡∏ö font size ‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á -->
  <div class="flex justify-between border-b border-gray-700 py-2 text-sm">
    <span>üèûÔ∏è</span>
    <span class="font-semibold">{{ num_tourism }}</span>
  </div>
  <div class="flex justify-between py-2 text-sm">
    <span>üçõ</span>
    <span class="font-semibold">{{ num_food }}</span>
  </div>
</div>
<div style="
  position: absolute; 
  bottom: 0.2rem; 
  right: 1.5rem; 
  background-color: #374151; 
  color: white; 
  border-radius: 9999px; 
  width: 2rem; 
  height: 2rem; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  cursor: pointer; 
  user-select: none;
">
  <span style="
    display: inline-block; 
    transform: translateY(-2px); 
    font-size: 1.25rem; 
    font-weight: 700; 
    line-height: 1;
  ">+</span>
</div>



  </div>
</a>
    <!-- Smart Environment -->
   <a href="/weather" style="text-decoration: none;">
  <div class="function_card" style="position: relative;">
    <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <span class="emoji_icon">üåè</span>
        <span class="topic_text">Smart Environment</span>
      </div>
      <span class="info-icon" id="infoToggleEnv" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
    </div>

    <!-- Tooltip box -->
    <div id="infoBoxEnv" class="tooltip-box">
      ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏°‡∏•‡∏û‡∏¥‡∏©
    </div>

    <div id="weather">
      <span id="weather-city"></span>
      <span id="weather-icon"></span>
      <span id="weather-temp" class="highlight-value"></span>
      <span id="weather-desc"></span>
    </div>
    <div id="aqi" class="switch-section hidden">
      <span id="aqi-city"></span>
      <span id="aqi-icon" style="font-size: 2.5rem;"></span>
      <span id="aqi-value" class="highlight-value"></span>
      <span id="aqi-desc"></span>
    </div>
    <div id="forecast-marquee" class="forecast-marquee"><span></span></div>
  </div>
</a>

    <!-- Other Cards -->
 <div class="function_card" style="position: relative;">
  <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <span class="emoji_icon">üèõÔ∏è</span>
      <span class="topic_text">Smart Governance</span>
    </div>
    <span class="info-icon" id="infoToggleGov" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
  </div>

  <!-- Tooltip box -->
  <div id="infoBoxGov" class="tooltip-box">
    ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ
  </div>
</div>

<a href="/camera" style="text-decoration: none;">
  <div class="function_card hover:shadow-lg transition" style="position: relative;">
    <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <span class="emoji_icon">üè†</span>
        <span class="topic_text">Smart Living</span>
      </div>
      <span class="info-icon" id="infoToggleLiving" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
    </div>


    <!-- Tooltip box -->
    <div id="infoBoxLiving" class="tooltip-box">
       ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡∏£‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏°‡∏µ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏†‡∏±‡∏¢‡∏à‡∏≤‡∏Å‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£‡∏£‡∏° ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡∏£‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
    </div>
    <div class="bg-gray-900 bg-opacity-60 rounded-xl mt-4 p-4 text-gray-200 shadow-lg font-sans w-72 max-w-full">
      <div class="flex justify-between py-2">
    <span class="text-lg">üé•CCTV</span>
    <span class="font-semibold">{{ num_cameras }}</span>
  </div>
  </div>
  </div>
</a>

<div class="function_card hover:shadow-lg transition" 
     onclick="window.location.href='/complaints'" 
     style="position: relative; cursor: pointer;">
  <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <span class="emoji_icon">üßëüèª‚Äçü§ù‚Äçüßëüèº</span>
      <span class="topic_text">Smart People</span>
    </div>
    <span class="info-icon" id="infoTogglePeople" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
  </div>

<div id="infoBoxPeople" class="tooltip-box">
       ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏û‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡∏£‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ô‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏™‡∏±‡∏á‡∏Ñ‡∏°
    </div>

  <div class="bg-gray-900 bg-opacity-60 rounded-xl w-72 text-gray-200 shadow-lg font-sans smart-people-content">
    <h3 class="text-yellow-400 font-extrabold text-xl mb-4 text-center">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</h3>
    <div class="flex justify-between border-b border-gray-700 py-2 w-full max-w-[280px]">
      <span class="text-lg">üßë‚Äçüíº ‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢</span>
      <span class="font-semibold">3,431 ‡∏Ñ‡∏ô</span>
    </div>
    <div class="flex justify-between border-b border-gray-700 py-2 w-full max-w-[280px]">
      <span class="text-lg">üë©‚Äçüíº ‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á</span>
      <span class="font-semibold">3,537 ‡∏Ñ‡∏ô</span>
    </div>
    <div class="flex justify-between py-2 w-full max-w-[280px]">
      <span class="text-sm">üìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô</span>
      <span class="text-sm">1,161.33 ‡∏Ñ‡∏ô/‡∏ï‡∏£.‡∏Å‡∏°.</span>
    </div>
  </div>
</div>




<a href="/Energy" style="text-decoration: none;">
  <div class="function_card" style="cursor: pointer; position: relative;">
    <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <span class="emoji_icon">üí°</span>
        <span class="topic_text">Smart Energy</span>
      </div>
      <span class="info-icon" id="infoToggleEnergy" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
    </div>
    <div class="energy-value" id="energy-value">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>

    <!-- Tooltip box -->
    <div id="infoBoxEnergy" class="tooltip-box">
      ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏≠‡∏≤‡∏î (Renewable Energy) ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏á‡∏ä‡∏µ‡∏ß‡∏°‡∏ß‡∏• ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô
    </div>
  </div>
</a>
<div class="function_card" style="position: relative;">
  <div class="header" style="display: flex; align-items: center; justify-content: space-between;">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <span class="emoji_icon">üöå</span>
      <span class="topic_text">Smart Mobility</span>
    </div>
    <span class="info-icon" id="infoToggleMobility" title="‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢">‚Ñπ</span>
  </div>

  <!-- Tooltip box -->
  <div id="infoBoxMobility" class="tooltip-box">
     ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏™‡πà‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ï‡∏£‡∏Å‡∏±‡∏ö‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°
  </div>
</div>



  <!-- JavaScript: Weather & AQI -->
  <script>
    // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏õ‡∏•‡∏á weathercode ‡πÄ‡∏õ‡πá‡∏ô Emoji + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
    function weatherCodeToEmojiDesc(code) {
      if (code === 0) return {emoji: "‚òÄÔ∏è", desc: "‡πÅ‡∏à‡πà‡∏°‡πÉ‡∏™"};
      if ([1,2,3].includes(code)) return {emoji: "‚õÖ", desc: "‡πÄ‡∏°‡∏Ü‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ñ‡∏∂‡∏á‡∏°‡∏≤‡∏Å"};
      if ([45,48].includes(code)) return {emoji: "üå´Ô∏è", desc: "‡∏´‡∏°‡∏≠‡∏Å"};
      if ([51,53,55].includes(code)) return {emoji: "üå¶Ô∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡∏õ‡∏£‡∏≠‡∏¢‡πÜ"};
      if ([56,57].includes(code)) return {emoji: "üåßÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡∏õ‡∏£‡∏≠‡∏¢‡πÅ‡∏Ç‡πá‡∏á"};
      if ([61,63,65].includes(code)) return {emoji: "üåßÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å"};
      if ([66,67].includes(code)) return {emoji: "üåßÔ∏è‚ùÑÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡πÅ‡∏Ç‡πá‡∏á"};
      if ([71,73,75].includes(code)) return {emoji: "‚ùÑÔ∏è", desc: "‡∏´‡∏¥‡∏°‡∏∞‡∏ï‡∏Å"};
      if (code === 77) return {emoji: "‚ùÑÔ∏è", desc: "‡πÄ‡∏Å‡∏•‡πá‡∏î‡∏´‡∏¥‡∏°‡∏∞"};
      if ([80,81,82].includes(code)) return {emoji: "üåßÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÜ"};
      if ([85,86].includes(code)) return {emoji: "‚ùÑÔ∏è", desc: "‡∏´‡∏¥‡∏°‡∏∞‡∏ï‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÜ"};
      if (code === 95) return {emoji: "‚õàÔ∏è", desc: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á"};
      if ([96,99].includes(code)) return {emoji: "‚õàÔ∏è‚ùÑÔ∏è", desc: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡πÄ‡∏´‡πá‡∏ö"};
      return {emoji: "üå°Ô∏è", desc: "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö"};
    }

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏à‡∏≤‡∏Å Open-Meteo
    async function fetchCurrentWeather() {
      try {
        const lat = 19.3010;
        const lon = 97.9654;
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=Asia/Bangkok`;

        const res = await fetch(url);
        const data = await res.json();

        const weatherCode = data.current_weather.weathercode;
        const temp = data.current_weather.temperature;

        const weatherInfo = weatherCodeToEmojiDesc(weatherCode);

        document.getElementById('weather-city').innerText = "‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô";
        document.getElementById('weather-icon').innerText = weatherInfo.emoji;
        document.getElementById('weather-temp').innerText = temp.toFixed(1) + "¬∞C";
        document.getElementById('weather-desc').innerText = weatherInfo.desc;
      } catch (e) {
        console.error("Error fetching current weather:", e);
      }
    }

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AQI ‡∏à‡∏≤‡∏Å OpenWeatherMap
    async function fetchAQI() {
      try {
        const lat = 19.3010;
        const lon = 97.9654;
        const apiKey = "9ba28f605e85242189e0c018fb078855";
        const url = `https://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=${apiKey}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error("HTTP error " + res.status);
        const data = await res.json();
        const aqi = data.list?.[0]?.main?.aqi || 0;

        const aqiEmoji = ["üü¢", "üü°", "üü†", "üî¥", "‚ö´"][aqi - 1] || "‚ùì";
        const aqiDesc = ["‡∏î‡∏µ‡∏°‡∏≤‡∏Å", "‡∏î‡∏µ", "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", "‡πÑ‡∏°‡πà‡∏î‡∏µ", "‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢"][aqi - 1] || "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡πà‡∏≤";

        document.getElementById('aqi-city').innerText = "‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô";
        document.getElementById('aqi-icon').innerText = aqiEmoji;
        document.getElementById('aqi-value').innerText = "AQI: " + (aqi > 0 ? aqi : "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö");
        document.getElementById('aqi-desc').innerText = aqiDesc;
      } catch (e) {
        console.error("AQI fetch error:", e);
      }
    }

    // ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Weather ‡∏Å‡∏±‡∏ö AQI ‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    function toggleSections() {
      const weather = document.getElementById("weather");
      const aqi = document.getElementById("aqi");
      if (weather.classList.contains("hidden")) {
        aqi.classList.add("fade-out-scale");
        weather.classList.remove("hidden");
        weather.classList.add("fade-in-scale");
        setTimeout(() => {
          aqi.classList.add("hidden");
          aqi.classList.remove("fade-out-scale");
        }, 600);
      } else {
        weather.classList.add("fade-out-scale");
        aqi.classList.remove("hidden");
        aqi.classList.add("fade-in-scale");
        setTimeout(() => {
          weather.classList.add("hidden");
          weather.classList.remove("fade-out-scale");
        }, 600);
      }
    }

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á interval ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï
    fetchCurrentWeather();
    fetchAQI();
    setInterval(fetchCurrentWeather, 600000); // ‡∏ó‡∏∏‡∏Å 10 ‡∏ô‡∏≤‡∏ó‡∏µ
    setInterval(fetchAQI, 600000); // ‡∏ó‡∏∏‡∏Å 10 ‡∏ô‡∏≤‡∏ó‡∏µ
    setInterval(toggleSections, 10000); // ‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

  </script>

  <!-- JavaScript: Forecast ‡∏à‡∏≤‡∏Å Open-Meteo -->
  <script>
    async function fetchForecast() {
      try {
        const lat = 19.301;
        const lon = 97.9654;
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_max,temperature_2m_min,weathercode&timezone=Asia/Bangkok`;

        const res = await fetch(url);
        const data = await res.json();

        const days = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™'];

        function weatherCodeToDesc(code) {
          switch(code) {
            case 0: return {emoji: "‚òÄÔ∏è", desc: "‡πÅ‡∏à‡πà‡∏°‡πÉ‡∏™"};
            case 1:
            case 2:
            case 3: return {emoji: "‚õÖ", desc: "‡πÄ‡∏°‡∏Ü‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ñ‡∏∂‡∏á‡∏°‡∏≤‡∏Å"};
            case 45:
            case 48: return {emoji: "üå´Ô∏è", desc: "‡∏´‡∏°‡∏≠‡∏Å"};
            case 51:
            case 53:
            case 55: return {emoji: "üå¶Ô∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡∏õ‡∏£‡∏≠‡∏¢‡πÜ"};
            case 56:
            case 57: return {emoji: "üåßÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡∏õ‡∏£‡∏≠‡∏¢‡πÅ‡∏Ç‡πá‡∏á"};
            case 61:
            case 63:
            case 65: return {emoji: "üåßÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å"};
            case 66:
            case 67: return {emoji: "üåßÔ∏è‚ùÑÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡πÅ‡∏Ç‡πá‡∏á"};
            case 71:
            case 73:
            case 75: return {emoji: "‚ùÑÔ∏è", desc: "‡∏´‡∏¥‡∏°‡∏∞‡∏ï‡∏Å"};
            case 77: return {emoji: "‚ùÑÔ∏è", desc: "‡πÄ‡∏Å‡∏•‡πá‡∏î‡∏´‡∏¥‡∏°‡∏∞"};
            case 80:
            case 81:
            case 82: return {emoji: "üåßÔ∏è", desc: "‡∏ù‡∏ô‡∏ï‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÜ"};
            case 85:
            case 86: return {emoji: "‚ùÑÔ∏è", desc: "‡∏´‡∏¥‡∏°‡∏∞‡∏ï‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÜ"};
            case 95: return {emoji: "‚õàÔ∏è", desc: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á"};
            case 96:
            case 99: return {emoji: "‚õàÔ∏è‚ùÑÔ∏è", desc: "‡∏û‡∏≤‡∏¢‡∏∏‡∏ù‡∏ô‡∏ü‡πâ‡∏≤‡∏Ñ‡∏∞‡∏ô‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡πÄ‡∏´‡πá‡∏ö"};
            default: return {emoji: "üå°Ô∏è", desc: "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö"};
          }
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå 7 ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡∏ï‡∏±‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 0 ‡∏≠‡∏≠‡∏Å ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)
        const forecastText = data.daily.time.slice(1, 8).map((dateStr, idx) => {
          const date = new Date(dateStr);
          const dayLabel = days[date.getDay()];
          const minTemp = data.daily.temperature_2m_min[idx+1].toFixed(0);
          const maxTemp = data.daily.temperature_2m_max[idx+1].toFixed(0);
          const weatherInfo = weatherCodeToDesc(data.daily.weathercode[idx+1]);
          return `${dayLabel} ${weatherInfo.emoji} (${weatherInfo.desc}) ${minTemp}¬∞C - ${maxTemp}¬∞C`;
        }).join(' | ');

        // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏á‡πÉ‡∏ô <span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ marquee ‡∏ß‡∏¥‡πà‡∏á
        document.querySelector("#forecast-marquee span").innerText = forecastText;

      } catch (err) {
        console.error("Forecast fetch error:", err);
        document.querySelector("#forecast-marquee span").innerText = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÑ‡∏î‡πâ";
      }
    }

    fetchForecast();
    setInterval(fetchForecast, 3600000); // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 1 ‡∏ä‡∏°.
  </script>

  <!-- JavaScript: Chart in Smart Economy -->
  <script>
    const ctx = document.getElementById('economyChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ["‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢."],
        datasets: [{
          label: 'GDP (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
          data: [250, 270, 260, 290, 310, 305],
          backgroundColor: 'rgba(0, 255, 204, 0.15)',
          borderColor: '#00ffcc',
          borderWidth: 2,
          tension: 0.3,
          fill: true,
          pointRadius: 4,
          pointHoverRadius: 6,
          pointBackgroundColor: '#00ffcc',
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        layout: { padding: { top: 20 } },
        plugins: {
          legend: { display: false },
          tooltip: { enabled: true },
          datalabels: {
            color: '#00ffcc',
            font: { weight: 'bold', size: 12 },
            anchor: 'center',
            align: 'bottom',
            formatter: (value) => value
          }
        },
        scales: {
          x: {
            grid: { display: false },
            ticks: {
              color: '#00ffcc',
              font: { size: 12 }
            }
          },
          y: {
            display: false,
            grid: { display: false },
            ticks: { display: false }
          }
        }
      },
      plugins: [ChartDataLabels]
    });
  </script>

  <!-- JavaScript: Energy -->
  <script>
    async function updateEnergy() {
      try {
        const res = await fetch("https://asia-northeast1-momay-4a073.cloudfunctions.net/api/sensorResident");
        const json = await res.json();

        const power = (json.power !== undefined && json.power !== null) ? json.power.toFixed(2) : "N/A";

        document.getElementById("energy-value").innerHTML = `
          <div>
            <span class="energy-status-indicator"></span>Power Consumption
          </div>
          <div style="font-size: 2rem; font-weight: 700; color: #ffce56;">
            ${power} kW
          </div>
        `;
      } catch (e) {
        console.error("Error fetching power:", e);
        document.getElementById("energy-value").innerText = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ";
      }
    }

    updateEnergy();
    setInterval(updateEnergy, 10000);
  </script>
  
<script>
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ã‡∏π‡∏°/‡∏•‡∏≤‡∏Å‡πÑ‡∏î‡πâ
  const mobilityMap = L.map('mobility-map').setView([19.3010, 97.9654], 13);

  // ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á OpenStreetMap
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '',
    maxZoom: 18
  }).addTo(mobilityMap);

  // ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô emoji üöå ‡πÅ‡∏ó‡∏ô
  const emojiIcon = L.divIcon({
    className: '',
    html: 'üöå',
    iconSize: [24, 24],
    iconAnchor: [12, 12]
  });

  // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå (‡∏à‡∏≥‡∏•‡∏≠‡∏á)
  const busStops = [
    { name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå ‡∏ö‡∏Ç‡∏™.‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô", lat: 19.303, lon: 97.967 },
    { name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡πÄ‡∏°‡∏∑‡∏≠‡∏á", lat: 19.298, lon: 97.961 },
    { name: "‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", lat: 19.310, lon: 97.970 }
  ];
19.35673,98.4382798
  // ‡∏ß‡∏≤‡∏á marker ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå
  busStops.forEach(stop => {
    L.marker([stop.lat, stop.lon], { icon: emojiIcon })
      .addTo(mobilityMap)
      .bindPopup(`<b>${stop.name}</b>`);
  });
</script>

    

<script>
const infoToggleEco = document.getElementById('infoToggleEco');
const infoBoxEco = document.getElementById('infoBoxEco');

const infoToggleEnv = document.getElementById('infoToggleEnv');
const infoBoxEnv = document.getElementById('infoBoxEnv');

const infoToggleGov = document.getElementById('infoToggleGov');
const infoBoxGov = document.getElementById('infoBoxGov');

const infoToggleLiving = document.getElementById('infoToggleLiving');
const infoBoxLiving = document.getElementById('infoBoxLiving');

const infoTogglePeople = document.getElementById('infoTogglePeople');
const infoBoxPeople = document.getElementById('infoBoxPeople');

const infoToggleEnergy = document.getElementById('infoToggleEnergy');
const infoBoxEnergy = document.getElementById('infoBoxEnergy');

const infoToggleMobility = document.getElementById('infoToggleMobility');
const infoBoxMobility = document.getElementById('infoBoxMobility');

infoToggleEco.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxEco.classList.toggle('show');
});

infoToggleEnv.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxEnv.classList.toggle('show');
});

infoToggleGov.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxGov.classList.toggle('show');
});

infoToggleLiving.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxLiving.classList.toggle('show');
  });


infoTogglePeople.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxPeople.classList.toggle('show');
});

infoToggleEnergy.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxEnergy.classList.toggle('show');
});

infoToggleMobility.addEventListener('click', (e) => {
  e.stopPropagation();
  e.preventDefault();
  infoBoxMobility.classList.toggle('show');
});

</script>
</body>
</html>
